library(vcfR)
library(ape)
library(chromoMap)
library(karyoploteR)
library(VariantAnnotation)
library(VennDiagram)
draw.pairwise.venn(area1 = 6315, area2 = 3139, cross.area = 2015, category = c("diploid", "tetraploid"))
draw.pairwise.venn(area1 = 6315, area2 = 3139,
cross.area = 2015,
category = c("diploid", "tetraploid"),
fill = c("#440154ff",'#21908dff','#fde725ff'),
alpha = c(0.3,0.3,0.3))
draw.pairwise.venn(area1 = 6315, area2 = 3139,
cross.area = 2015,
category = c("diploid", "tetraploid"),
fill = c("#440154ff",'#21908dff'),
alpha = c(0.3,0.3))
draw.triple.venn(area1 = 6238 , area2 = 6282, area3 = 5605,
n12 = 5785, n13 = 4473, n23 = 4404, n123 = 4335,
category = c('6.1', '4.0.4', 'Solyntus'),
output = TRUE ,
imagetype="png" ,
#height = 480 ,
#width = 480 ,
#resolution = 300,
#compression = "lzw",
lwd = 3,
col=c("#440154ff", '#21908dff', '#fde725ff'),
fill = c("#440154ff",'#21908dff','#fde725ff'),
alpha = c(0.3,0.3,0.3),
#cex = 0.5,
fontfamily = "sans",
cat.cex = 1.2,
cat.default.pos = "outer",
#cat.pos = c(-27, 27, 135),
#cat.dist = c(0.055, 0.055, 0.085),
#cat.fontfamily = "sans",
#cat.col = c("#440154ff", '#21908dff', '#fde725ff'),
rotation = 1)
vcf_path <- file.path('/media/rna/CYSTOPHORA/GWAS/scripts/vcf_analysis/isec_404_to_601/404_SNPs.vcf')
dna_path <- file.path('data/References/6.1_chr09.fa')
#vcf_file_6.1 <- vcfR::read.vcfR(vcf_path)
#dna_file_6.1 <- ape::read.dna(dna_path, format = "fasta")
#chrom_6.1 <- create.chromR(name = 'Chr09_6.1', vcf = vcf_file_6.1, seq = dna_file_6.1)
#chrom_6.1 <- proc.chromR(chrom_6.1, verbose=TRUE, win.size = 100000)
#chromoqc(chrom_6.1)
#generiert mit bcftools query
chr_file = "/media/rna/CYSTOPHORA/GWAS/scripts/vcf_analysis/isec_404_to_601/chr.txt"
anno_file = "/media/rna/CYSTOPHORA/GWAS/scripts/vcf_analysis/isec_404_to_601/404_pos.txt"
#chromoMap(chr_file,anno_file)
#          data_type = "numeric",
#          plots = "bar")
# VCF as GRanges
#vcf <- readVcf(vcf_path, )
#vcfGRanges <- vcfWhich(vcf)
pos_404 <- read.delim("/media/rna/CYSTOPHORA/GWAS/scripts/vcf_analysis/isec_404_to_61/404_pos.txt", header=FALSE)
pos_404$V4 <- pos_404$V3 + 1
colnames(pos_404) <- c("n", "chr", "start", "end")
grange404 = makeGRangesFromDataFrame(pos_404)
pos_61 <- read.delim("/media/rna/CYSTOPHORA/GWAS/scripts/vcf_analysis/isec_404_to_61/61_pos.txt", header=FALSE)
pos_61$V4 <- pos_61$V3 + 1
colnames(pos_61) <- c("n", "chr", "start", "end")
grange61 = makeGRangesFromDataFrame(pos_61)
pos_both <- read.delim("/media/rna/CYSTOPHORA/GWAS/scripts/vcf_analysis/isec_404_to_61/404_61_overlap.txt", header=FALSE)
pos_both$V4 <- pos_both$V3 + 1
colnames(pos_both) <- c("n", "chr", "start", "end")
grange_both = makeGRangesFromDataFrame(pos_both)
custom.genome <- toGRanges(data.frame(chr="chr09", start=1, end=67600300))
kp <- plotKaryotype(genome = custom.genome)
kpPlotDensity(kp, data=grange404, window.size = 100000, r0=0, r1=0.3, col="blue")
kpPlotDensity(kp, data=grange61, window.size = 100000, r0=0.33, r1=0.63, col="red")
kpPlotDensity(kp, data=grange_both, window.size = 100000, r0=0.66, r1=1, col="orchid")
kpAddLabels(kp, labels = " SNPs 4.0.4", r0=0, r1=0.3)
kpAddLabels(kp, labels = "SNPs 6.1", r0=0.33, r1=0.63)
kpAddLabels(kp, labels = "SNPs in both", r0=0.66, r1=1)
draw.triple.venn(area1 = 6238 , area2 = 6282, area3 = 5605,
n12 = 5785, n13 = 4473, n23 = 4404, n123 = 4335,
category = c('6.1', '4.0.4', 'Solyntus'),
output = TRUE ,
imagetype="png" ,
#height = 480 ,
#width = 480 ,
#resolution = 300,
#compression = "lzw",
lwd = 3,
col=c("#440154ff", '#21908dff', '#fde725ff'),
fill = c("#440154ff",'#21908dff','#fde725ff'),
alpha = c(0.3,0.3,0.3),
#cex = 0.5,
fontfamily = "sans",
cat.cex = 1.2,
cat.default.pos = "outer",
#cat.pos = c(-27, 27, 135),
#cat.dist = c(0.055, 0.055, 0.085),
#cat.fontfamily = "sans",
#cat.col = c("#440154ff", '#21908dff', '#fde725ff'),
rotation = 1)
draw.pairwise.venn(area1 = 6315, area2 = 3139,
cross.area = 2015,
category = c("diploid", "tetraploid"),
fill = c("#440154ff",'#21908dff'),
alpha = c(0.3,0.3))
